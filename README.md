# IERG3050 Project: Predicting Student Performance with Machine Learning

This project develops and evaluates machine learning models to predict student pass/fail outcomes using simulated and real datasets. It compares logistic regression (basic, regularized, balanced, SMOTE, polynomial), generalized linear models (GLM), Bayesian logistic regression, and deep learning approaches, addressing class imbalance (e.g., 5.106 in real data). The project includes data preparation, model training, evaluation, and visualization of results like ROC curves and feature importance.

## Project Objectives
- **Objective 3**: Compare multiple models (e.g., Bayesian, deep learning) for binary and multi-class prediction.
- **Objective 5**: Generate insights for a report, including metrics (accuracy, ROC-AUC) and visualizations (e.g., `roc_curve_sim.png`).

## Prerequisites
- **Python**: Version 3.9 recommended.
- **Virtual Environment**: To isolate dependencies.
- **Operating System**: Tested on macOS (M1/M2 Macs, uses `tensorflow-macos`).
- **Input Files**: Ensure `outputs/simulated_student_data.csv` and `outputs/cleaned_real_data.csv` exist (generated by `simulate_data.py` and `clean_real_data.py`).

## Installation

1. **Clone the Repository** (if applicable):
   ```bash
   git clone <repository-url>
   cd IERG3050_Project

2. **Set Up Virtual Environment** :
    ```bash
    python3 -m venv ierg3050_env
    source ierg3050_env/bin/activate

3. **Install Dependencies: Install all required libraries using pip. Run** :
    ```bash
    pip install pandas==1.5.3 numpy==1.24.3 scikit-learn==1.5.2 statsmodels==0.14.0 imblearn==0.10.1 pymc==5.6.0 arviz==0.12.1 tensorflow-macos==2.12.0 matplotlib==3.7.1 seaborn==0.12.2

**Libraries** :
- `pandas`: Data handling.
- `numpy`: Numerical operations.
- `scikit-learn`: Logistic regression, SMOTE, polynomial features.
- `statsmodels`: GLM models.
- `imblearn`: SMOTE for imbalance.
- `pymc, arviz`: Bayesian modeling.
- `tensorflow-macos`: Deep learning (M1/M2 Macs).
- `matplotlib, seaborn`: Visualizations.

4. **Verify Installation** :
    ```bash
    python3 -c "import pandas, numpy, sklearn, statsmodels, imblearn, pymc, arviz, tensorflow, matplotlib, seaborn; print('All libraries installed')"


## Usage
1. Generate Input Data: Run the data preparation scripts (not provided here, assumed available):
    ```bash
    python3 simulate_data.py
    python3 clean_real_data.py
- Creates `outputs/simulated_student_data.csv` and `outputs/cleaned_real_data.csv`.
2. Train Models: Train all models (logistic regression, GLM, Bayesian, deep learning):
    ```bash
    python3 train_model.py
- Output:
- Models: `outputs/basic_model_sim.pkl`, `outputs/dl_real.keras`, `outputs/bayesian_sim.nc`, etc.
- Test data: `outputs/X_sim_test.npy`, `outputs/y_real_test.npy`, etc.
- Console: Class distributions (e.g., simulated imbalance: 1.787), GLM summaries, deep learning epochs (~0.8241 accuracy).
3. Evaluate and Visualize: Evaluate models and generate visualizations:
    ```bash
    python3 evaluate_visualize.py
- Output:
- Metrics: `outputs/evaluation_metrics.csv` (e.g., simulated basic: ~0.725, deep learning: ~0.70).
- Visualizations: `outputs/roc_curve_sim.png`, `outputs/bayesian_posterior.png`, etc.
- Console: Accuracy, F1-score, ROC-AUC, confusion matrices.
4. Clear Outputs (Optional): To rerun with fresh results:
    ```bash
    rm -rf outputs/*
    mkdir outputs

## Project Structure
- **train_model.py**: Trains models on simulated and real data.
- **evaluate_visualize.py**: Evaluates models and generates plots.
- **simulate_data.py**: Generates simulated student data.
- **clean_real_data.py**: Cleans real dataset.
- **outputs/**: Stores models, test data, metrics, and visualizations.

## Expected Results
- **Metrics (evaluation_metrics.csv):** :
- Simulated Basic: ~0.725 accuracy, ~0.798 ROC-AUC.
- Simulated Polynomial: ~0.710 accuracy, ~0.794 ROC-AUC.
- Simulated Bayesian: ~0.725 accuracy.
- Real Deep Learning: ~0.70 accuracy, ~0.65 ROC-AUC (due to 5.106 imbalance).
- **Visualizations** :
- ROC curves: `roc_curve_sim.png`, `roc_curve_real.png`.
- Feature importance: `feature_importance_sim.png`.
- Bayesian posterior: `bayesian_posterior.png`.

## Scikit-Learn Warning
    ```bash
    FutureWarning: `BaseEstimator._validate_data` is deprecated...
- Safe to ignore. Fixed by pinning scikit-learn==1.5.2.